
  this->PreUpdate( filter.GetPointer() );

$(if measurements then
temp=false
for i = 1,#measurements do
  if measurements[i].active then
    temp=true
    OUT=OUT..'  this->m_pfGet'..measurements[i].name..' = nsstd::bind(&FilterType::Get'..measurements[i].name..', filter.GetPointer());\
'
  end
end
if temp then
OUT=OUT..[[

  // release the old filter ( and output data )
  if ( this->m_Filter != NULL)
    {
      this->m_Filter->UnRegister();
      this->m_Filter = NULL;
    }

  this->m_Filter = filter;
  this->m_Filter->Register();
]]
end
end)

  // Run the ITK filter and return the output as a SimpleITK image
  filter->Update();

$(when measurements $(foreach measurements
$(if not active and custom_itk_cast then
  OUT=[[  ${custom_itk_cast}]]
elseif not active then
  OUT=[[  this->m_${name} = filter->Get${name}();]]
end)))

  typename FilterType::OutputImageType *itkOutImage = filter->GetOutput();
  this->FixNonZeroIndex( itkOutImage );
  return Image( itkOutImage );
